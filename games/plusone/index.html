<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plus One Game</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <link rel="stylesheet" href="styles/plusonemain.css">
</head>
<body>
    <!-- Back to games navigation -->
    <a href="../../index.html" class="back-button">
        <i class="fas fa-arrow-left"></i>
        Back to Games
    </a>
    
    <!-- Main game area -->
    <div class="game-area">
        <!-- Rainbow container -->
        <div class="rainbow-container" id="rainbowContainer">
            <!-- Rainbow arcs will be added here by JavaScript -->
        </div>
        
        <!-- Separate pulse areas for green flashing -->
        <div class="left-pulse-area" id="leftPulseArea"></div>
        <div class="right-pulse-area" id="rightPulseArea"></div>
        
        <!-- Left side for content (positioned for proper content placement: 6%-40% horizontal, 30%-90% vertical) -->
        <div class="left-side" id="leftSide">
            <!-- Left side content will be added here by JavaScript -->
        </div>
        
        <!-- Middle section with operator sign (46%-54% horizontal) -->
        <div class="middle-section">
            <div class="plus-sign" id="operatorSign">
                <i class="fas fa-plus" id="operatorIcon"></i>
            </div>
        </div>
        
        <!-- Right side for content (positioned for proper content placement: 60%-94% horizontal, 30%-90% vertical) -->
        <div class="right-side" id="rightSide">
            <!-- Right side content will be added here by JavaScript -->
        </div>
        
        <!-- Sum row at bottom -->
        <div class="sum-row" id="sumRow">
            <div class="input-box left-sum-box" id="leftInputBox"></div>
            <div class="sum-plus-sign" id="sumOperator">+</div>
            <div class="input-box right-sum-box" id="rightInputBox"></div>
            <div class="sum-equals-sign">=</div>
            <div class="input-box total-sum-box" id="totalInputBox"></div>
            <div class="check-mark" id="checkMark">
                <i class="fas fa-check"></i>
            </div>
        </div>
    </div>
    
    <!-- Empty container for universal button system -->
    <div class="number-buttons"></div>
    
    <!-- Game completion modal -->
    <div class="modal hidden" id="gameModal">
        <div class="modal-content">
            <h2>ðŸŒˆ Well Done! ðŸŒˆ</h2>
            <button class="play-again-btn" id="playAgainBtn">PLAY AGAIN</button>
        </div>
    </div>
    
    <!-- JavaScript files - Load universal systems first -->
    <script src="js/plusoneconfig.js"></script>
    <script src="../../js/shared/buttonbar.js"></script>
    <script src="../../js/shared/audio.js"></script>
    <script src="../../js/shared/rainbow.js"></script>
    <script src="../../js/shared/Bear.js"></script>
    <script src="../../js/shared/statsmanager.js"></script>
    <!-- Then game-specific files -->
    <script src="js/plusonestats.js"></script>
    <script src="js/plusoneiconrenderer.js"></script>
    <script src="js/plusonegamecontroller.js"></script>
    
    <!-- TEMPORARY: Stats display for testing - remove in production -->
    <script>
        /**
         * Temporary Stats Display for Testing
         * Shows live stats during gameplay
         */
        class StatsDisplay {
            constructor() {
                this.createDisplay();
                this.updateInterval = null;
                this.startUpdating();
            }

            createDisplay() {
                this.container = document.createElement('div');
                this.container.id = 'stats-display';
                this.container.style.cssText = `
                    position: fixed;
                    top: 10px;
                    left: 50%;
                    transform: translateX(-50%);
                    background: rgba(0, 0, 0, 0.8);
                    color: white;
                    padding: 10px 15px;
                    border-radius: 8px;
                    font-family: Arial, sans-serif;
                    font-size: 12px;
                    z-index: 9999;
                    display: grid;
                    grid-template-columns: repeat(4, 1fr);
                    gap: 15px;
                    min-width: 400px;
                    text-align: center;
                `;

                this.accuracyEl = this.createStatElement('Accuracy', '0%');
                this.resilienceEl = this.createStatElement('Resilience', '0%');
                this.speedEl = this.createStatElement('Speed', '0%');
                this.varietyEl = this.createStatElement('Variety', '0%');

                this.container.appendChild(this.accuracyEl);
                this.container.appendChild(this.resilienceEl);
                this.container.appendChild(this.speedEl);
                this.container.appendChild(this.varietyEl);

                document.body.appendChild(this.container);
                this.createToggleButton();
            }

            createStatElement(label, value) {
                const element = document.createElement('div');
                element.innerHTML = `
                    <div style="font-weight: bold; margin-bottom: 2px;">${label}</div>
                    <div class="stat-value" style="color: #4CAF50; font-size: 14px;">${value}</div>
                `;
                return element;
            }

            createToggleButton() {
                const button = document.createElement('button');
                button.innerHTML = 'ðŸ“Š';
                button.style.cssText = `
                    position: fixed;
                    top: 10px;
                    right: 10px;
                    background: rgba(0, 0, 0, 0.8);
                    color: white;
                    border: none;
                    padding: 8px 12px;
                    border-radius: 50%;
                    cursor: pointer;
                    font-size: 16px;
                    z-index: 10000;
                `;
                
                button.addEventListener('click', () => {
                    this.container.style.display = 
                        this.container.style.display === 'none' ? 'grid' : 'none';
                });

                document.body.appendChild(button);
            }

            startUpdating() {
                this.updateInterval = setInterval(() => {
                    this.updateStats();
                }, 1000);
            }

            updateStats() {
                if (!window.plusOneGame || !window.plusOneGame.stats) return;

                const stats = window.plusOneGame.stats.getCurrentStats();
                const debug = {
                    questions: window.plusOneGame.stats.totalQuestions,
                    correct: window.plusOneGame.stats.correctFirstAttempts,
                    rounds: window.plusOneGame.stats.roundsCompleted,
                    activeTime: Math.round(window.plusOneGame.stats.totalActiveTime / 1000),
                    avgResponseTime: window.plusOneGame.stats.questionTimes.length > 0 ? 
                        Math.round((window.plusOneGame.stats.questionTimes.reduce((a, b) => a + b, 0) / window.plusOneGame.stats.questionTimes.length) * 100) / 100 : 0
                };

                const accuracyEl = this.accuracyEl.querySelector('.stat-value');
                accuracyEl.textContent = `${stats.accuracy}%`;
                accuracyEl.title = `${debug.correct}/${debug.questions} first attempts`;

                const resilienceEl = this.resilienceEl.querySelector('.stat-value');
                resilienceEl.textContent = `${stats.resilience}%`;
                resilienceEl.title = `${debug.rounds} rounds, ${debug.activeTime}s active`;

                const speedEl = this.speedEl.querySelector('.stat-value');
                speedEl.textContent = `${stats.speed}%`;
                speedEl.title = `Avg: ${debug.avgResponseTime}s per question`;

                const varietyEl = this.varietyEl.querySelector('.stat-value');
                varietyEl.textContent = `${stats.variety}%`;
                varietyEl.title = `${debug.rounds > 0 ? 'Round completed' : 'No rounds completed'}`;

                [accuracyEl, resilienceEl, speedEl, varietyEl].forEach((el, i) => {
                    const value = [stats.accuracy, stats.resilience, stats.speed, stats.variety][i];
                    if (value >= 80) el.style.color = '#4CAF50';
                    else if (value >= 60) el.style.color = '#FF9800';
                    else if (value >= 40) el.style.color = '#FFC107';
                    else el.style.color = '#F44336';
                });
            }

            destroy() {
                if (this.updateInterval) {
                    clearInterval(this.updateInterval);
                }
                if (this.container) {
                    this.container.remove();
                }
            }
        }

        // Auto-initialize stats display
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                if (window.plusOneGame) {
                    window.statsDisplay = new StatsDisplay();
                    console.log('ðŸ“Š Stats display initialized for testing');
                }
            }, 2000);
        });

        window.addEventListener('beforeunload', () => {
            if (window.statsDisplay) {
                window.statsDisplay.destroy();
            }
        });
    </script>
</body>
</html>
